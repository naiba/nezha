{{define "theme-server-status/home"}}
{{template "theme-server-status/header" .}}
<div id="app">
    {{template "theme-server-status/content-nav" .}}   
    <!--  showGroup true -->
    <template v-if="showGroup">
        <section class="container table-responsive content" style="max-width: 95vw" v-for="group in nodesTag">
            {{template "theme-server-status/home-group-true" .}} 
        </section>
    </template>
    <!--  showGroup false -->
    <template v-else>
        <section class="container table-responsive content" style="max-width: 95vw">
            {{template "theme-server-status/home-group-false" .}}
        </section>
    </template>
    <div class="modal fade" id="mapChartBox" tabindex="-1" role="dialog" aria-labelledby="mapChartTitle" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="mapChartTitle">ÊúçÂä°Âô®‰∏ñÁïåÂàÜÂ∏ÉÂõæ</h4>
                    <i class="bi bi-x" data-dismiss="modal" aria-label="Close"></i>
                </div>
                <div class="modal-body">
                    <div id="mapChart" style="width:100%;height:auto;"></div>
                </div>
            </div>
        </div>
    </div>
    {{template "theme-server-status/content-footer" .}}
</div>
<script>
    new Vue({
        el: '#app',
        delimiters: ['@#', '#@'],
        data: {
            page: 'index',
            defaultTemplate: {{.Conf.Site.Theme}},
            templates: {{.Themes}},
            cache: [],
            servers: [],
            nodesTag: [],
            nodesNoTag: [],
            chartDataList: [],
            ws: null,
            countryMap: {"ad":{"flag":"üá¶üá©","en":"Andorra","zh":"ÂÆâÈÅìÂ∞î"},"ae":{"flag":"üá¶üá™","en":"United Arab Emirates","zh":"ÈòøËÅîÈÖã"},"af":{"flag":"üá¶üá´","en":"Afghanistan","zh":"ÈòøÂØåÊ±ó"},"ag":{"flag":"üá¶üá¨","en":"Antigua and Barb.","zh":"ÂÆâÊèêÁìúÂíåÂ∑¥Â∏ÉËææ"},"ai":{"flag":"üá¶üáÆ","en":"Anguilla","zh":"ÂÆâÂú≠Êãâ"},"al":{"flag":"üá¶üá±","en":"Albania","zh":"ÈòøÂ∞îÂ∑¥Â∞º‰∫ö"},"am":{"flag":"üá¶üá≤","en":"Armenia","zh":"‰∫öÁæéÂ∞º‰∫ö"},"ao":{"flag":"üá¶üá¥","en":"Angola","zh":"ÂÆâÂì•Êãâ"},"aq":{"flag":"üá¶üá∂","en":"Antarctica","zh":"ÂçóÊûÅÊ¥≤"},"ar":{"flag":"üá¶üá∑","en":"Argentina","zh":"ÈòøÊ†πÂª∑"},"as":{"flag":"üá¶üá∏","en":"American Samoa","zh":"ÁæéÂ±ûËê®Êë©‰∫ö"},"Ashmore and Cartier Is.":{"flag":"","en":"Ashmore and Cartier Is.","zh":"Èòø‰ªÄËé´Â∞îÂíåÂç°Êç∑Áæ§Â≤õ"},"at":{"flag":"üá¶üáπ","en":"Austria","zh":"Â••Âú∞Âà©"},"au":{"flag":"üá¶üá∫","en":"Australia","zh":"Êæ≥Â§ßÂà©‰∫ö"},"aw":{"flag":"üá¶üáº","en":"Aruba","zh":"ÈòøÈ≤ÅÂ∑¥"},"ax":{"flag":"üá¶üáΩ","en":"√Öland","zh":"Â••ÂÖ∞"},"az":{"flag":"üá¶üáø","en":"Azerbaijan","zh":"ÈòøÂ°ûÊãúÁñÜ"},"ba":{"flag":"üáßüá¶","en":"Bosnia and Herz.","zh":"Ê≥¢Èªë"},"bb":{"flag":"üáßüáß","en":"Barbados","zh":"Â∑¥Â∑¥Â§öÊñØ"},"bd":{"flag":"üáßüá©","en":"Bangladesh","zh":"Â≠üÂä†ÊãâÂõΩ"},"be":{"flag":"üáßüá™","en":"Belgium","zh":"ÊØîÂà©Êó∂"},"bf":{"flag":"üáßüá´","en":"Burkina Faso","zh":"Â∏ÉÂü∫Á∫≥Ê≥ïÁ¥¢"},"bg":{"flag":"üáßüá¨","en":"Bulgaria","zh":"‰øùÂä†Âà©‰∫ö"},"bh":{"flag":"üáßüá≠","en":"Bahrain","zh":"Â∑¥Êûó"},"bi":{"flag":"üáßüáÆ","en":"Burundi","zh":"Â∏ÉÈöÜËø™"},"bj":{"flag":"üáßüáØ","en":"Benin","zh":"Ë¥ùÂÆÅ"},"bl":{"flag":"üáßüá±","en":"St-Barth√©lemy","zh":"Âú£Â∑¥Ê≥∞ÂãíÁ±≥"},"bm":{"flag":"üáßüá≤","en":"Bermuda","zh":"ÁôæÊÖïÂ§ß"},"bn":{"flag":"üáßüá≥","en":"Brunei","zh":"ÊñáËé±"},"bo":{"flag":"üáßüá¥","en":"Bolivia","zh":"ÁéªÂà©Áª¥‰∫ö"},"bq":{"flag":"üáßüá∂","en":"Bonaire, Sint Eustatius and Saba","zh":"Ëç∑ÂÖ∞Âä†ÂãíÊØîÂå∫"},"br":{"flag":"üáßüá∑","en":"Brazil","zh":"Â∑¥Ë•ø"},"bs":{"flag":"üáßüá∏","en":"Bahamas","zh":"Â∑¥ÂìàÈ©¨"},"bt":{"flag":"üáßüáπ","en":"Bhutan","zh":"‰∏ç‰∏π"},"bv":{"flag":"üáßüáª","en":"Bouvet Island","zh":"Â∏ÉÈü¶Â≤õ"},"bw":{"flag":"üáßüáº","en":"Botswana","zh":"ÂçöËå®Áì¶Á∫≥"},"by":{"flag":"üáßüáæ","en":"Belarus","zh":"ÁôΩ‰øÑÁΩóÊñØ"},"bz":{"flag":"üáßüáø","en":"Belize","zh":"‰ºØÂà©ÂÖπ"},"ca":{"flag":"üá®üá¶","en":"Canada","zh":"Âä†ÊãøÂ§ß"},"cc":{"flag":"üá®üá®","en":"Cocos (Keeling) Islands","zh":"ÁßëÁßëÊñØÔºàÂü∫ÊûóÔºâÁæ§Â≤õ"},"cd":{"flag":"üá®üá©","en":"Dem. Rep. Congo","zh":"ÂàöÊûúÊ∞ë‰∏ªÂÖ±ÂíåÂõΩ"},"cf":{"flag":"üá®üá´","en":"Central African Rep.","zh":"‰∏≠Èùû"},"cg":{"flag":"üá®üá¨","en":"Congo","zh":"ÂàöÊûúÂÖ±ÂíåÂõΩ"},"ch":{"flag":"üá®üá≠","en":"Switzerland","zh":"ÁëûÂ£´"},"ci":{"flag":"üá®üáÆ","en":"C√¥te d'Ivoire","zh":"ÁßëÁâπËø™Áì¶"},"ck":{"flag":"üá®üá∞","en":"Cook Is.","zh":"Â∫ìÂÖãÁæ§Â≤õ"},"cl":{"flag":"üá®üá±","en":"Chile","zh":"Êô∫Âà©"},"cm":{"flag":"üá®üá≤","en":"Cameroon","zh":"ÂñÄÈ∫¶ÈöÜ"},"cn":{"flag":"üá®üá≥","en":"China","zh":"‰∏≠ÂõΩ"},"co":{"flag":"üá®üá¥","en":"Colombia","zh":"Âì•‰º¶ÊØî‰∫ö"},"cr":{"flag":"üá®üá∑","en":"Costa Rica","zh":"Âì•ÊñØËææÈªéÂä†"},"cu":{"flag":"üá®üá∫","en":"Cuba","zh":"Âè§Â∑¥"},"cv":{"flag":"üá®üáª","en":"Cabo Verde","zh":"‰ΩõÂæóËßí"},"cw":{"flag":"üá®üáº","en":"Cura√ßao","zh":"Â∫ìÊãâÁ¥¢"},"cx":{"flag":"üá®üáΩ","en":"Christmas Island","zh":"Âú£ËØûÂ≤õ"},"cy":{"flag":"üá®üáæ","en":"Cyprus","zh":"Â°ûÊµ¶Ë∑ØÊñØ"},"cz":{"flag":"üá®üáø","en":"Czech Rep.","zh":"Êç∑ÂÖã"},"de":{"flag":"üá©üá™","en":"Germany","zh":"Âæ∑ÂõΩ"},"dj":{"flag":"üá©üáØ","en":"Djibouti","zh":"ÂêâÂ∏ÉÊèê"},"dk":{"flag":"üá©üá∞","en":"Denmark","zh":"‰∏πÈ∫¶"},"dm":{"flag":"üá©üá≤","en":"Dominica","zh":"Â§öÁ±≥Â∞ºÂÖã"},"do":{"flag":"üá©üá¥","en":"Dominican Rep.","zh":"Â§öÁ±≥Â∞ºÂä†"},"dz":{"flag":"üá©üáø","en":"Algeria","zh":"ÈòøÂ∞îÂèäÂà©‰∫ö"},"ec":{"flag":"üá™üá®","en":"Ecuador","zh":"ÂéÑÁìúÂ§öÂ∞î"},"ee":{"flag":"üá™üá™","en":"Estonia","zh":"Áà±Ê≤ôÂ∞º‰∫ö"},"eg":{"flag":"üá™üá¨","en":"Egypt","zh":"ÂüÉÂèä"},"eh":{"flag":"üá™üá≠","en":"W. Sahara","zh":"Ë•øÊííÂìàÊãâ"},"er":{"flag":"üá™üá∑","en":"Eritrea","zh":"ÂéÑÁ´ãÁâπÈáå‰∫ö"},"es":{"flag":"üá™üá∏","en":"Spain","zh":"Ë•øÁè≠Áâô"},"et":{"flag":"üá™üáπ","en":"Ethiopia","zh":"ÂüÉÂ°û‰øÑÊØî‰∫ö"},"fi":{"flag":"üá´üáÆ","en":"Finland","zh":"Ëä¨ÂÖ∞"},"fj":{"flag":"üá´üáØ","en":"Fiji","zh":"ÊñêÊµé"},"fk":{"flag":"üá´üá∞","en":"Falkland Is.","zh":"Á¶èÂÖãÂÖ∞Áæ§Â≤õ"},"fm":{"flag":"üá´üá≤","en":"Micronesia","zh":"ÂØÜÂÖãÁΩóÂ∞ºË•ø‰∫öËÅîÈÇ¶"},"fo":{"flag":"üá´üá¥","en":"Faeroe Is.","zh":"Ê≥ïÁΩóÁæ§Â≤õ"},"fr":{"flag":"üá´üá∑","en":"France","zh":"Ê≥ïÂõΩ"},"ga":{"flag":"üá¨üá¶","en":"Gabon","zh":"Âä†Ëì¨"},"gb":{"flag":"üá¨üáß","en":"United Kingdom","zh":"Ëã±ÂõΩ"},"gd":{"flag":"üá¨üá©","en":"Grenada","zh":"Ê†ºÊûóÁ∫≥Ëææ"},"ge":{"flag":"üá¨üá™","en":"Georgia","zh":"Ê†ºÈ≤ÅÂêâ‰∫ö"},"gf":{"flag":"üá¨üá´","en":"French Guiana","zh":"Ê≥ïÂ±ûÂú≠‰∫öÈÇ£"},"gg":{"flag":"üá¨üá¨","en":"Guernsey","zh":"Ê†πË•ø"},"gh":{"flag":"üá¨üá≠","en":"Ghana","zh":"Âä†Á∫≥"},"gi":{"flag":"üá¨üáÆ","en":"Gibraltar","zh":"Áõ¥Â∏ÉÁΩóÈôÄ"},"gl":{"flag":"üá¨üá±","en":"Greenland","zh":"Ê†ºÈôµÂÖ∞"},"gm":{"flag":"üá¨üá≤","en":"Gambia","zh":"ÂÜàÊØî‰∫ö"},"gn":{"flag":"üá¨üá≥","en":"Guinea","zh":"Âá†ÂÜÖ‰∫ö"},"gp":{"flag":"üá¨üáµ","en":"Guadeloupe","zh":"ÁìúÂæ∑ÁΩóÊôÆ"},"gq":{"flag":"üá¨üá∂","en":"Eq. Guinea","zh":"Ëµ§ÈÅìÂá†ÂÜÖ‰∫ö"},"gr":{"flag":"üá¨üá∑","en":"Greece","zh":"Â∏åËÖä"},"gs":{"flag":"üá¨üá∏","en":"S. Geo. and the Is.","zh":"Âçó‰πîÊ≤ª‰∫öÂíåÂçóÊ°ëÂ®ÅÂ•áÁæ§Â≤õ"},"gt":{"flag":"üá¨üáπ","en":"Guatemala","zh":"Âç±Âú∞È©¨Êãâ"},"gu":{"flag":"üá¨üá∫","en":"Guam","zh":"ÂÖ≥Â≤õ"},"gw":{"flag":"üá¨üáº","en":"Guinea-Bissau","zh":"Âá†ÂÜÖ‰∫öÊØîÁªç"},"gy":{"flag":"üá¨üáæ","en":"Guyana","zh":"Âú≠‰∫öÈÇ£"},"hk":{"flag":"üá≠üá∞","en":"Hong Kong","zh":"È¶ôÊ∏Ø"},"hm":{"flag":"üá≠üá≤","en":"Heard I. and McDonald Is.","zh":"Ëµ´Âæ∑Â≤õÂíåÈ∫¶ÂÖãÂîêÁ∫≥Áæ§Â≤õ"},"hn":{"flag":"üá≠üá≥","en":"Honduras","zh":"Ê¥™ÈÉΩÊãâÊñØ"},"hr":{"flag":"üá≠üá∑","en":"Croatia","zh":"ÂÖãÁΩóÂú∞‰∫ö"},"ht":{"flag":"üá≠üáπ","en":"Haiti","zh":"Êµ∑Âú∞"},"hu":{"flag":"üá≠üá∫","en":"Hungary","zh":"ÂåàÁâôÂà©"},"id":{"flag":"üáÆüá©","en":"Indonesia","zh":"Âç∞Â∫¶Â∞ºË•ø‰∫ö"},"ie":{"flag":"üáÆüá™","en":"Ireland","zh":"Áà±Â∞îÂÖ∞"},"il":{"flag":"üáÆüá±","en":"Israel","zh":"‰ª•Ëâ≤Âàó"},"im":{"flag":"üáÆüá≤","en":"Isle of Man","zh":"È©¨ÊÅ©Â≤õ"},"in":{"flag":"üáÆüá≥","en":"India","zh":"Âç∞Â∫¶"},"Indian Ocean Ter.":{"flag":"üá®üáΩüá®üá®","en":"Indian Ocean Ter.","zh":"Êæ≥Â±ûÂç∞Â∫¶Ê¥ãÈ¢ÜÂú∞"},"io":{"flag":"üáÆüá¥","en":"Br. Indian Ocean Ter.","zh":"Ëã±Â±ûÂç∞Â∫¶Ê¥ãÈ¢ÜÂú∞"},"iq":{"flag":"üáÆüá∂","en":"Iraq","zh":"‰ºäÊãâÂÖã"},"ir":{"flag":"üáÆüá∑","en":"Iran","zh":"‰ºäÊúó"},"is":{"flag":"üáÆüá∏","en":"Iceland","zh":"ÂÜ∞Â≤õ"},"it":{"flag":"üáÆüáπ","en":"Italy","zh":"ÊÑèÂ§ßÂà©"},"je":{"flag":"üáØüá™","en":"Jersey","zh":"Ê≥ΩË•ø"},"jm":{"flag":"üáØüá≤","en":"Jamaica","zh":"Áâô‰π∞Âä†"},"jo":{"flag":"üáØüá¥","en":"Jordan","zh":"Á∫¶Êó¶"},"jp":{"flag":"üáØüáµ","en":"Japan","zh":"Êó•Êú¨"},"ke":{"flag":"üá∞üá™","en":"Kenya","zh":"ËÇØÂ∞º‰∫ö"},"kg":{"flag":"üá∞üá¨","en":"Kyrgyzstan","zh":"ÂêâÂ∞îÂêâÊñØÊñØÂù¶"},"kh":{"flag":"üá∞üá≠","en":"Cambodia","zh":"Êü¨ÂüîÂØ®"},"ki":{"flag":"üá∞üáÆ","en":"Kiribati","zh":"Âü∫ÈáåÂ∑¥ÊñØ"},"km":{"flag":"üá∞üá≤","en":"Comoros","zh":"ÁßëÊë©ÁΩó"},"kn":{"flag":"üá∞üá≥","en":"St. Kitts and Nevis","zh":"Âú£Âü∫Ëå®ÂíåÂ∞ºÁª¥ÊñØ"},"Kosovo":{"flag":"üáΩüá∞","en":"Kosovo","zh":"ÁßëÁ¥¢Ê≤É"},"kp":{"flag":"üá∞üáµ","en":"Dem. Rep. Korea","zh":"ÊúùÈ≤ú"},"kr":{"flag":"üá∞üá∑","en":"Korea","zh":"Èü©ÂõΩ"},"kw":{"flag":"üá∞üáº","en":"Kuwait","zh":"ÁßëÂ®ÅÁâπ"},"ky":{"flag":"üá∞üáæ","en":"Cayman Is.","zh":"ÂºÄÊõºÁæ§Â≤õ"},"kz":{"flag":"üá∞üáø","en":"Kazakhstan","zh":"ÂìàËê®ÂÖãÊñØÂù¶"},"la":{"flag":"üá±üá¶","en":"Lao PDR","zh":"ËÄÅÊåù"},"lb":{"flag":"üá±üáß","en":"Lebanon","zh":"ÈªéÂ∑¥Â´©"},"lc":{"flag":"üá±üá®","en":"Saint Lucia","zh":"Âú£Âç¢Ë•ø‰∫ö"},"li":{"flag":"üá±üáÆ","en":"Liechtenstein","zh":"ÂàóÊîØÊï¶Â£´Áôª"},"lk":{"flag":"üá±üá∞","en":"Sri Lanka","zh":"ÊñØÈáåÂÖ∞Âç°"},"lr":{"flag":"üá±üá∑","en":"Liberia","zh":"Âà©ÊØîÈáå‰∫ö"},"ls":{"flag":"üá±üá∏","en":"Lesotho","zh":"Ëé±Á¥¢Êâò"},"lt":{"flag":"üá±üáπ","en":"Lithuania","zh":"Á´ãÈô∂ÂÆõ"},"lu":{"flag":"üá±üá∫","en":"Luxembourg","zh":"Âç¢Ê£ÆÂ†°"},"lv":{"flag":"üá±üáª","en":"Latvia","zh":"ÊãâËÑ±Áª¥‰∫ö"},"ly":{"flag":"üá±üáæ","en":"Libya","zh":"Âà©ÊØî‰∫ö"},"ma":{"flag":"üá≤üá¶","en":"Morocco","zh":"Êë©Ê¥õÂì•"},"mc":{"flag":"üá≤üá®","en":"Monaco","zh":"Êë©Á∫≥Âì•"},"md":{"flag":"üá≤üá©","en":"Moldova","zh":"Êë©Â∞îÂ§öÁì¶"},"me":{"flag":"üá≤üá™","en":"Montenegro","zh":"ÈªëÂ±±"},"mf":{"flag":"üá≤üá´","en":"St-Martin","zh":"Ê≥ïÂ±ûÂú£È©¨‰∏Å"},"mg":{"flag":"üá≤üá¨","en":"Madagascar","zh":"È©¨ËææÂä†ÊñØÂä†"},"mh":{"flag":"üá≤üá≠","en":"Marshall Is.","zh":"È©¨ÁªçÂ∞îÁæ§Â≤õ"},"mk":{"flag":"üá≤üá∞","en":"Macedonia","zh":"ÂåóÈ©¨ÂÖ∂È°ø"},"ml":{"flag":"üá≤üá±","en":"Mali","zh":"È©¨Èáå"},"mm":{"flag":"üá≤üá≤","en":"Myanmar","zh":"ÁºÖÁî∏"},"mn":{"flag":"üá≤üá≥","en":"Mongolia","zh":"ËíôÂè§"},"mo":{"flag":"üá≤üá¥","en":"Macao","zh":"Êæ≥Èó®"},"mp":{"flag":"üá≤üáµ","en":"N. Mariana Is.","zh":"ÂåóÈ©¨Èáå‰∫öÁ∫≥Áæ§Â≤õ"},"mq":{"flag":"üá≤üá∂","en":"Martinique","zh":"È©¨ÊèêÂ∞ºÂÖã"},"mr":{"flag":"üá≤üá∑","en":"Mauritania","zh":"ÊØõÈáåÂ°îÂ∞º‰∫ö"},"ms":{"flag":"üá≤üá∏","en":"Montserrat","zh":"ËíôÁâπÂ°ûÊãâÁâπ"},"mt":{"flag":"üá≤üáπ","en":"Malta","zh":"È©¨ËÄ≥‰ªñ"},"mu":{"flag":"üá≤üá∫","en":"Mauritius","zh":"ÊØõÈáåÊ±ÇÊñØ"},"mv":{"flag":"üá≤üáª","en":"Maldives","zh":"È©¨Â∞î‰ª£Â§´"},"mw":{"flag":"üá≤üáº","en":"Malawi","zh":"È©¨ÊãâÁª¥"},"mx":{"flag":"üá≤üáΩ","en":"Mexico","zh":"Â¢®Ë•øÂì•"},"my":{"flag":"üá≤üáæ","en":"Malaysia","zh":"È©¨Êù•Ë•ø‰∫ö"},"mz":{"flag":"üá≤üáø","en":"Mozambique","zh":"Ëé´Ê°ëÊØîÂÖã"},"N. Cyprus":{"flag":"","en":"N. Cyprus","zh":"ÂåóÂ°ûÊµ¶Ë∑ØÊñØ"},"na":{"flag":"üá≥üá¶","en":"Namibia","zh":"Á∫≥Á±≥ÊØî‰∫ö"},"nc":{"flag":"üá≥üá®","en":"New Caledonia","zh":"Êñ∞ÂñÄÈáåÂ§öÂ∞º‰∫ö"},"ne":{"flag":"üá≥üá™","en":"Niger","zh":"Â∞ºÊó•Â∞î"},"nf":{"flag":"üá≥üá´","en":"Norfolk Island","zh":"ËØ∫Á¶èÂÖãÂ≤õ"},"ng":{"flag":"üá≥üá¨","en":"Nigeria","zh":"Â∞ºÊó•Âà©‰∫ö"},"ni":{"flag":"üá≥üáÆ","en":"Nicaragua","zh":"Â∞ºÂä†ÊãâÁìú"},"nl":{"flag":"üá≥üá±","en":"Netherlands","zh":"Ëç∑ÂÖ∞"},"no":{"flag":"üá≥üá¥","en":"Norway","zh":"Êå™Â®Å"},"np":{"flag":"üá≥üáµ","en":"Nepal","zh":"Â∞ºÊ≥äÂ∞î"},"nr":{"flag":"üá≥üá∑","en":"Nauru","zh":"ÁëôÈ≤Å"},"nu":{"flag":"üá≥üá∫","en":"Niue","zh":"Á∫ΩÂüÉ"},"nz":{"flag":"üá≥üáø","en":"New Zealand","zh":"Êñ∞Ë•øÂÖ∞"},"om":{"flag":"üá¥üá≤","en":"Oman","zh":"ÈòøÊõº"},"pa":{"flag":"üáµüá¶","en":"Panama","zh":"Â∑¥ÊãøÈ©¨"},"pe":{"flag":"üáµüá™","en":"Peru","zh":"ÁßòÈ≤Å"},"pf":{"flag":"üáµüá´","en":"Fr. Polynesia","zh":"Ê≥ïÂ±ûÊ≥¢Âà©Â∞ºË•ø‰∫ö"},"pg":{"flag":"üáµüá¨","en":"Papua New Guinea","zh":"Â∑¥Â∏É‰∫öÊñ∞Âá†ÂÜÖ‰∫ö"},"ph":{"flag":"üáµüá≠","en":"Philippines","zh":"Ëè≤ÂæãÂÆæ"},"pk":{"flag":"üáµüá∞","en":"Pakistan","zh":"Â∑¥Âü∫ÊñØÂù¶"},"pl":{"flag":"üáµüá±","en":"Poland","zh":"Ê≥¢ÂÖ∞"},"pm":{"flag":"üáµüá≤","en":"St. Pierre and Miquelon","zh":"Âú£ÁöÆÂüÉÂ∞îÂíåÂØÜÂÖãÈöÜ"},"pn":{"flag":"üáµüá≥","en":"Pitcairn Is.","zh":"ÁöÆÁâπÂáØÊÅ©Áæ§Â≤õ"},"pr":{"flag":"üáµüá∑","en":"Puerto Rico","zh":"Ê≥¢Â§öÈªéÂêÑ"},"ps":{"flag":"üáµüá∏","en":"Palestine","zh":"Â∑¥ÂãíÊñØÂù¶"},"pt":{"flag":"üáµüáπ","en":"Portugal","zh":"Ëë°ËêÑÁâô"},"pw":{"flag":"üáµüáº","en":"Palau","zh":"Â∏ïÂä≥"},"py":{"flag":"üáµüáæ","en":"Paraguay","zh":"Â∑¥ÊãâÂú≠"},"qa":{"flag":"üá∂üá¶","en":"Qatar","zh":"Âç°Â°îÂ∞î"},"re":{"flag":"üá∑üá™","en":"R√©union","zh":"ÁïôÂ∞ºÊ±™"},"ro":{"flag":"üá∑üá¥","en":"Romania","zh":"ÁΩóÈ©¨Â∞º‰∫ö"},"rs":{"flag":"üá∑üá∏","en":"Serbia","zh":"Â°ûÂ∞îÁª¥‰∫ö"},"ru":{"flag":"üá∑üá∫","en":"Russia","zh":"‰øÑÁΩóÊñØ"},"rw":{"flag":"üá∑üáº","en":"Rwanda","zh":"Âç¢Êó∫Ëææ"},"sa":{"flag":"üá∏üá¶","en":"Saudi Arabia","zh":"Ê≤ôÁâπÈòøÊãâ‰ºØ"},"sb":{"flag":"üá∏üáß","en":"Solomon Is.","zh":"ÊâÄÁΩóÈó®Áæ§Â≤õ"},"sc":{"flag":"üá∏üá®","en":"Seychelles","zh":"Â°ûËàåÂ∞î"},"sd":{"flag":"üá∏üá©","en":"Sudan","zh":"Ëãè‰∏π"},"se":{"flag":"üá∏üá™","en":"Sweden","zh":"ÁëûÂÖ∏"},"sg":{"flag":"üá∏üá¨","en":"Singapore","zh":"Êñ∞Âä†Âù°"},"sh":{"flag":"üá∏üá≠","en":"Saint Helena","zh":"Âú£Ëµ´ÂãíÊãø"},"si":{"flag":"üá∏üáÆ","en":"Slovenia","zh":"ÊñØÊ¥õÊñáÂ∞º‰∫ö"},"Siachen Glacier":{"flag":"","en":"Siachen Glacier","zh":"Èî°‰∫öÁê¥ÂÜ∞Â∑ù"},"sj":{"flag":"üá∏üáØ","en":"Svalbard and Jan Mayen","zh":"ÊñØÁì¶Â∞îÂ∑¥ÂíåÊâ¨È©¨Âª∂"},"sk":{"flag":"üá∏üá∞","en":"Slovakia","zh":"ÊñØÊ¥õ‰ºêÂÖã"},"sl":{"flag":"üá∏üá±","en":"Sierra Leone","zh":"Â°ûÊãâÂà©ÊòÇ"},"sm":{"flag":"üá∏üá≤","en":"San Marino","zh":"Âú£È©¨ÂäõËØ∫"},"sn":{"flag":"üá∏üá≥","en":"Senegal","zh":"Â°ûÂÜÖÂä†Â∞î"},"so":{"flag":"üá∏üá¥","en":"Somalia","zh":"Á¥¢È©¨Èáå"},"Somaliland":{"flag":"","en":"Somaliland","zh":"Á¥¢È©¨ÈáåÂÖ∞"},"sr":{"flag":"üá∏üá∑","en":"Suriname","zh":"ËãèÈáåÂçó"},"ss":{"flag":"üá∏üá∏","en":"S. Sudan","zh":"ÂçóËãè‰∏π"},"st":{"flag":"üá∏üáπ","en":"S√£o Tom√© and Principe","zh":"Âú£Â§öÁæéÂíåÊôÆÊûóË•øÊØî"},"sv":{"flag":"üá∏üáª","en":"El Salvador","zh":"Ëê®Â∞îÁì¶Â§ö"},"sx":{"flag":"üá∏üáΩ","en":"Sint Maarten","zh":"Ëç∑Â±ûÂú£È©¨‰∏Å"},"sy":{"flag":"üá∏üáæ","en":"Syria","zh":"ÂèôÂà©‰∫ö"},"sz":{"flag":"üá∏üáø","en":"Swaziland","zh":"ÊñØÂ®ÅÂ£´ÂÖ∞"},"tc":{"flag":"üáπüá®","en":"Turks and Caicos Is.","zh":"ÁâπÂÖãÊñØÂíåÂáØÁßëÊñØÁæ§Â≤õ"},"td":{"flag":"üáπüá©","en":"Chad","zh":"‰πçÂæó"},"tf":{"flag":"üáπüá´","en":"Fr. S. Antarctic Lands","zh":"Ê≥ïÂ±ûÂçóÈÉ®ÂíåÂçóÊûÅÈ¢ÜÂú∞"},"tg":{"flag":"üáπüá¨","en":"Togo","zh":"Â§öÂì•"},"th":{"flag":"üáπüá≠","en":"Thailand","zh":"Ê≥∞ÂõΩ"},"tj":{"flag":"üáπüáØ","en":"Tajikistan","zh":"Â°îÂêâÂÖãÊñØÂù¶"},"tk":{"flag":"üáπüá∞","en":"Tokelau","zh":"ÊâòÂÖãÂä≥"},"tl":{"flag":"üáπüá±","en":"Timor-Leste","zh":"‰∏úÂ∏ùÊ±∂"},"tm":{"flag":"üáπüá≤","en":"Turkmenistan","zh":"ÂúüÂ∫ìÊõºÊñØÂù¶"},"tn":{"flag":"üáπüá≥","en":"Tunisia","zh":"Á™ÅÂ∞ºÊñØ"},"to":{"flag":"üáπüá¥","en":"Tonga","zh":"Ê±§Âä†"},"tr":{"flag":"üáπüá∑","en":"Turkey","zh":"ÂúüËÄ≥ÂÖ∂"},"tt":{"flag":"üáπüáπ","en":"Trinidad and Tobago","zh":"ÁâπÁ´ãÂ∞ºËææÂíåÂ§öÂ∑¥Âì•"},"tv":{"flag":"üáπüáª","en":"Tuvalu","zh":"ÂõæÁì¶Âç¢"},"tw":{"flag":"üáπüáº","en":"Taiwan","zh":"Âè∞Êπæ"},"tz":{"flag":"üáπüáø","en":"Tanzania","zh":"Âù¶Ê°ëÂ∞º‰∫ö"},"ua":{"flag":"üá∫üá¶","en":"Ukraine","zh":"‰πåÂÖãÂÖ∞"},"ug":{"flag":"üá∫üá¨","en":"Uganda","zh":"‰πåÂπ≤Ëææ"},"um":{"flag":"üá∫üá≤","en":"U.S. Minor Outlying Is.","zh":"ÁæéÂõΩÊú¨ÂúüÂ§ñÂ∞èÂ≤õÂ±ø"},"us":{"flag":"üá∫üá∏","en":"United States","zh":"ÁæéÂõΩ"},"uy":{"flag":"üá∫üáæ","en":"Uruguay","zh":"‰πåÊãâÂú≠"},"uz":{"flag":"üá∫üáø","en":"Uzbekistan","zh":"‰πåÂÖπÂà´ÂÖãÊñØÂù¶"},"va":{"flag":"üáªüá¶","en":"Vatican","zh":"Ê¢µËíÇÂÜà"},"vc":{"flag":"üáªüá®","en":"St. Vin. and Gren.","zh":"Âú£ÊñáÊ£ÆÁâπÂíåÊ†ºÊûóÁ∫≥‰∏ÅÊñØ"},"ve":{"flag":"üáªüá™","en":"Venezuela","zh":"ÂßîÂÜÖÁëûÊãâ"},"vg":{"flag":"üáªüá¨","en":"British Virgin Is.","zh":"Ëã±Â±ûÁª¥Â∞î‰∫¨Áæ§Â≤õ"},"vi":{"flag":"üáªüáÆ","en":"U.S. Virgin Is.","zh":"ÁæéÂ±ûÁª¥Â∞î‰∫¨Áæ§Â≤õ"},"vn":{"flag":"üáªüá≥","en":"Vietnam","zh":"Ë∂äÂçó"},"vu":{"flag":"üáªüá∫","en":"Vanuatu","zh":"Áì¶Âä™ÈòøÂõæ"},"wf":{"flag":"üáºüá´","en":"Wallis and Futuna Is.","zh":"Áì¶Âà©ÊñØÂíåÂØåÂõæÁ∫≥"},"ws":{"flag":"üáºüá∏","en":"Samoa","zh":"Ëê®Êë©‰∫ö"},"ye":{"flag":"üáæüá™","en":"Yemen","zh":"‰πüÈó®"},"yt":{"flag":"üáæüáπ","en":"Mayotte","zh":"È©¨Á∫¶Áâπ"},"za":{"flag":"üáøüá¶","en":"South Africa","zh":"ÂçóÈùû"},"zm":{"flag":"üáøüá≤","en":"Zambia","zh":"ËµûÊØî‰∫ö"},"zw":{"flag":"üáøüáº","en":"Zimbabwe","zh":"Ê¥•Â∑¥Â∏ÉÈü¶"}},
            countryServer: [],
            countryNameMap: {},
            countryMapChartData: []
        },
        mixins: [mixinsVue],
        created() {
            this.servers = JSON.parse('{{.Servers}}').servers;
            if(this.showGroup) {
                this.nodesTag = this.groupingData(this.handleNodes(this.servers),"Tag");
            } else {
                this.nodesNoTag = this.handleNodes(this.servers);
            }
            this.countryNameMap = this.initCountryNameMap();
            this.countryServer = this.initCountryServer();
            this.countryMapChartData = this.initCountryMapChartData();
        },
        mounted() {
            // ÂàùÂßãÂåñÊó∂Âª∫Á´ãWebSocketËøûÊé•
            this.connect();
            // ÁõëÂê¨È°µÈù¢ÂèØËßÅÊÄßÂèòÂåñ
            document.addEventListener("visibilitychange", () => {
                if (document.visibilityState === "visible") {
                    setTimeout(() => {
                        if (document.hasFocus()) {
                            this.connect();
                        }
                    }, 200);
                }
            });
        },
        methods: {
            initCountryNameMap(){
                const result = {};
                for (const item in this.countryMap) {
                    result[this.countryMap[item].en] = this.countryMap[item].zh;
                }
                return result;
            },
            initCountryServer() {
                let count = {};
                let result = [];
                let exist = {};
                this.servers.forEach(item => {
                    item.Host.CountryCode = 'cn';
                    if (item.Host.CountryCode) {
                        if(item.Host.CountryCode.toLowerCase() == 'tw' || item.Host.CountryCode.toLowerCase() == 'hk' || item.Host.CountryCode.toLowerCase() == 'mo') item.Host.CountryCode = 'cn';
                        if (!exist[item.Host.CountryCode]) {
                            exist[item.Host.CountryCode] = true;
                            count[item.Host.CountryCode] = 1;
                            const obj = {
                                'countryCode': item.Host.CountryCode,
                                'count': count[item.Host.CountryCode]
                            };
                            result.push(obj);
                        } else {
                            count[item.Host.CountryCode]++;
                            result.find(obj => obj.countryCode === item.Host.CountryCode).count = count[item.Host.CountryCode];
                        }
                    }
                });
                return result;
            },
            initCountryMapChartData(){
                let result = [];
                this.countryServer.forEach(item => {
                    var obj = {
                        "name": this.countryMap[item.countryCode].zh,
                        "value": item.count
                    }
                    result.push(obj);
                });
                return result;
            },
            showMapChart(){
                // Â§ÑÁêÜÂºÇÂ∏∏
                if( this.countryMapChartData.length == 0 ) {
                    console.log('init countryMapChartData not complete');
                    return;
                }
                const isMobile = this.checkIsMobile();
                const width = isMobile ? 338 : 1102;
                const height = isMobile ? 200 : 500;
                const backgroundColor = this.theme == "dark" ? '#1C1D26' : '#ffffff';
                const inRangeColor = this.theme == "dark" ? '#D2B206' : '#FFDF32';
                const tooltipBackgroundColor = this.theme == "dark" ? "#ffffff" : '#ffffff';
                const tooltipBorderColor = this.theme == "dark" ? "#ffffff" : "#ffffff"; 
                const fontSize = isMobile ? 10 : 12;
                const fontColor = this.theme == "dark" ? "#000000" : "#000000";     
                const chartContainer = document.getElementById('mapChart');
                const mapChart = echarts.init(chartContainer, '', { // initÂõæË°®
                    renderer: 'canvas',
                    useDirtyRect: false,
                    width: width,
                    height: height,
                });
                const option = {
                    title: {
                        show: false,
                    },
                    backgroundColor: backgroundColor,
                    grid: {
                        top: 0,
                        left: 10,
                        right: 10
                    },
                    tooltip: {
                        trigger: 'item',
                        formatter: function (params) {
                            if (params.data && params.data.value > 0) {
                                return params.name + params.data.value + 'Âè∞';
                            } else {
                                return '';
                            }
                        },
                        backgroundColor: tooltipBackgroundColor,
                        borderColor: tooltipBorderColor,
                        padding: [4,10],
                        textStyle: {
                            fontSize: fontSize,
                            color: fontColor
                        }
                    },
                    visualMap: {
                        show: false,
                        min: 0,
                        max: 1000,
                        calculable: false,
                        inRange: {
                            color: inRangeColor
                        }
                    },
                    series: [
                        {
                            type: 'map',
                            mapType: 'world',
                            roam: true,
                            label: {
                                show: false,
                                fontSize: 8
                            },
                            data: this.countryMapChartData,
                            nameMap: this.countryNameMap,
                        }
                    ]
                };
                mapChart.setOption(option);
            },
            isWindowsPlatform(str) {
                return str.includes('Windows')
            },
            getFontLogoClass(str) {
                if (["almalinux",
                        "alpine",
                        "aosc",
                        "apple",
                        "archlinux",
                        "archlabs",
                        "artix",
                        "budgie",
                        "centos",
                        "coreos",
                        "debian",
                        "deepin",
                        "devuan",
                        "docker",
                        "elementary",
                        "fedora",
                        "ferris",
                        "flathub",
                        "freebsd",
                        "gentoo",
                        "gnu-guix",
                        "illumos",
                        "kali-linux",
                        "linuxmint",
                        "mageia",
                        "mandriva",
                        "manjaro",
                        "nixos",
                        "openbsd",
                        "opensuse",
                        "pop-os",
                        "raspberry-pi",
                        "redhat",
                        "rocky-linux",
                        "sabayon",
                        "slackware",
                        "snappy",
                        "solus",
                        "tux",
                        "ubuntu",
                        "void",
                        "zorin"].indexOf(str)
                    > -1) {
                    return str;
                }
                if (['openwrt', 'linux', "immortalwrt"].indexOf(str) > -1) {
                    return 'tux';
                }
                if (str == 'amazon') {
                    return 'redhat';
                }
                if (str == 'arch') {
                    return 'archlinux';
                }
                return '';
            },
            secondToDate(s) {
                const d = Math.floor(s / 3600 / 24);
                if (d > 0) {
                    return d + ' {{tr "Day"}}'
                }
                const h = Math.floor(s / 3600 % 24);
                const m = Math.floor(s / 60 % 60);
                const second = Math.floor(s % 60);
                return h + ":" + ("0" + m).slice(-2) + ":" + ("0" + second).slice(-2);
            },
            formatTimestamp(t) {
                return new Date(t * 1000).toLocaleString()
            },
            formatByteSize(bs) {
                const x = this.readableBytes(bs)
                return x !== "NaN undefined" ? x : '0B'
            },
            formatPercent(live, used, total) {
                //const percent = live ? (this.toFixed2(used / total * 100) || 0) : 0
                const percent = (this.toFixed2(used / total * 100) || 0)
                return this.formatPercents(live,percent)
            },
            formatPercents(live,percent) {
                //if(!live) { percent = 0; }
                if (percent <= 0) {
                    percent = 0;
                }
                if (percent >= 100) {
                    percent = 100;
                }
                if (!this.cache[percent]) {
                    this.cache[percent] = {
                        class: 'progress-bar progress-bar-success',
                        style: `width: ${parseInt(percent)+1}%`,
                        percent,
                    }
                    if (percent < 80) {
                        this.cache[percent].class = 'progress-bar progress-bar-success'
                    } else if (percent < 90) {
                        this.cache[percent].class = 'progress-bar progress-bar-warning'
                    } else {
                        this.cache[percent].class = 'progress-bar progress-bar-danger'
                    }
                }
                return this.cache[percent]
            },
            readableBytes(bytes) {
                if (!bytes) {
                    return '0B'
                }
                const i = Math.floor(Math.log(bytes) / Math.log(1024)),
                    sizes = ["B", "K", "M", "G", "T", "P", "E", "Z", "Y"];
                return parseFloat((bytes / Math.pow(1024, i)).toFixed(2)) + sizes[i];
            },
            connect() {
                // Â¶ÇÊûúÂ∑≤ÁªèÂ≠òÂú® WebSocket ËøûÊé•Âπ∂‰∏îÂ§Ñ‰∫éÂºÄÂêØÁä∂ÊÄÅÔºåÂàô‰∏çÈáçÂ§çÂª∫Á´ãËøûÊé•
                if (this.ws && this.ws.readyState === WebSocket.OPEN) {
                    console.log('Closing old WebSocket connection...');
                    this.ws.close();
                }
                const wsProtocol = window.location.protocol === "https:" ? "wss" : "ws";
                this.ws = new WebSocket(wsProtocol + '://' + window.location.host + '/ws');

                this.ws.onopen = function () {
                    console.log("Connection open ...")
                }
                this.ws.onmessage = (evt) => {
                    let jsonData = evt.data
                    const data = JSON.parse(jsonData)
                    for (let i = 0; i < data.servers?.length; i++) {
                        const ns = data.servers[i];
                        if (!ns.Host) {
                            data.servers[i].live = false
                        } else {
                            const lastActive = new Date(ns.LastActive).getTime()
                            data.servers[i].live = data.now - lastActive <= 10 * 1000;
                        }
                    }
                    if(this.showGroup) {
                        this.nodesTag = this.groupingData(this.handleNodes(data.servers),"Tag");
                    } else {
                        this.nodesNoTag = this.handleNodes(data.servers);
                    }
                }
                this.ws.onclose = () => {
                    setTimeout(() => {
                        this.connect();
                    }, 5000);
                };
                this.ws.onerror = () => {
                    this.ws.close()
                }
            },
            handleNodes(servers) {
                let nodes = []
                servers?.forEach(server => {
                    let platform = server.Host.Platform;
                    if (this.isWindowsPlatform(platform)) {
                        platform = "windows"
                    }else if (platform === "immortalwrt") {
                        platform = "openwrt"
                    }
                    let node = {
                        ID: server.ID,
                        name: server.Name,
                        os: platform,
                        location: server.Host.CountryCode,
                        uptime: this.secondToDate(server.State.Uptime),
                        load: this.toFixed2(server.State.Load1),
                        network: this.getNetworkSpeed(server.State.NetInSpeed, server.State.NetOutSpeed),
                        traffic: this.formatByteSize(server.State.NetInTransfer) + ' | ' + this.formatByteSize(server.State.NetOutTransfer),
                        cpu: this.formatPercents(server.live, this.toFixed2(server.State.CPU)),
                        memory: this.formatPercent(server.live, server.State.MemUsed, server.Host.MemTotal),
                        hdd: this.formatPercent(server.live, server.State.DiskUsed, server.Host.DiskTotal),
                        online: server.live,
                        state: server.State,
                        host: server.Host,
                        lastActive: server.LastActive,
                        Tag: server.Tag,
                    }
                    nodes.push(node)
                })
                return nodes;
            },
            getNetworkSpeed(netInSpeed, netOutSpeed) {
                return this.formatByteSize(netInSpeed) + ' | ' + this.formatByteSize(netOutSpeed)
            },
            showCharts(event, id) {
                const chartContainer = this.$refs[`chart${id}`][0];
                const chartboxShow = chartContainer.getAttribute('chartbox-show');
                chartContainer.setAttribute('chartbox-show', chartboxShow === '0' ? '1' : '0');
                const isAriaExpandedFalse = event.currentTarget.getAttribute('aria-expanded') === 'false';
                if (!isAriaExpandedFalse) return;
                // ÂèëËµ∑Êï∞ÊçÆËØ∑Ê±Ç
                const url = `/api/v1/monitor/${id}`;
                fetch(url)
                    .then(response => response.json())
                    .then(data => {
                        if (data.result) { // Êï∞ÊçÆËØ∑Ê±ÇÊàêÂäüÔºåÊõ¥Êñ∞Êï∞ÊçÆÂπ∂Ê∏≤ÊüìÂõæË°®
                            this.chartDataList[id - 1] = data.result;
                            this.$nextTick(() => {
                                this.renderCharts(id);
                            });
                        } else {
                            console.log('this agent (id:'+ id + ') has no monitor.');
                        }
                    })
                    .catch(error => {
                        console.error('Error fetching data:', error);
                    });
            },
            renderCharts(id, reload = false) {
                if (!this.chartDataList[id - 1]) return;
                const chartData = this.chartDataList[id - 1];
                const chartContainer = this.$refs[`chart${id}`][0];
                if (reload) { //ÁÇπÂáªÂàáÊç¢‰∫ÆËâ≤/ÊöóËâ≤È£éÊ†ºÊ®°ÂºèÊó∂,ÈáçÊñ∞ËΩΩÂÖ•echartsÂõæË°®ÁöÑÈÄªËæë,
                    // Á¨¨‰∏ÄÊ≠•,Êü•ÊâæÂ∑≤ÁªèÊ∏≤ÊüìÂá∫ÁöÑÂõæË°®ÂÆπÂô®,Âπ∂ÈîÄÊØÅÂÆÉ
                    const existingChart = echarts.getInstanceByDom(chartContainer);
                    if (existingChart) existingChart.dispose();
                    // Á¨¨‰∫åÊ≠•,Â¶ÇÊûúÂõæË°®ÂÆπÂô®Â§Ñ‰∫é‰∏çÂèØËßÅÁä∂ÊÄÅchartboxShow=0,‰∏çÈáçÊñ∞Ê∏≤ÊüìÂá∫Êñ∞ÁöÑÂõæË°®,
                    // Â¶ÇÊûúÂõæË°®ÂÆπÂô®Â§Ñ‰∫éÂèØËßÅÁä∂ÊÄÅchartboxShow=1,ÈáçÊñ∞Ê∏≤ÊüìÂá∫Êñ∞ÁöÑÂõæË°®
                    const chartboxShow = chartContainer.getAttribute('chartbox-show');
                    if ( chartboxShow === '0' ) return; 
                }
                // ÂÆö‰πâÂõæË°®ÂèÇÊï∞ÂÄº
                const MaxTCPPingValue = {{.Conf.MaxTCPPingValue}} ? {{.Conf.MaxTCPPingValue}} : 300;
                const isMobile = this.checkIsMobile();
                const fontSize = isMobile ? 10 : 14;
                const gridLeft = isMobile ? 25 : 36;
                const gridRight = isMobile ? 5 : 20;
                const legendLeft = isMobile ? 'center' : 'center';
                const legendTop = isMobile ? 5 : 5;
                const legendPadding= isMobile ? [5,0,5,0] : [5,0,5,0];
                const systemDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
                const theme = localStorage.getItem("theme") ? localStorage.getItem("theme") : systemDarkMode;
                const chartTheme = theme == "dark" ? "dark" : "default";
                const fontColor = theme == "dark" ? "#f1f1f1" : "#000000";
                const backgroundColor = theme == "dark" ? "#1C1D26" : '';
                const tooltipBackgroundColor = theme == "dark" ? "#1C1D26" : '#ffffff';
                const tooltipBorderColor = theme == "dark" ? "#31363B" : "#ffffff";
                // Ê∏≤ÊüìÂõæË°®
                const chart = echarts.init(chartContainer, chartTheme, {
                    renderer: 'canvas',
                    useDirtyRect: false,
                    width: 'auto',
                    height: 300,
                });
                const xAxisData = chartData[0].created_at.map(time => new Date(time).toLocaleString());
                const seriesData = chartData.map(item => {
                    let loss = 0;
                    const data = item.avg_delay.map((avgDelay, index) => {                        
                        if(avgDelay > 0 && avgDelay < MaxTCPPingValue){
                            loss += avgDelay > 0.9 * MaxTCPPingValue ? 1 : 0;
                            return [item.created_at[index], avgDelay];
                        }else{
                            loss += 1;
                        }
                    });
                    const lossRate = ((loss / item.created_at.length) * 100).toFixed(1);
                    item.monitor_name = item.monitor_name.includes("%") ? item.monitor_name : `${item.monitor_name} ${lossRate}%`;
                    return {
                        name: item.monitor_name,
                        type: 'line',
                        smooth: true,
                        symbol: 'none',
                        data: data,
                        connectNulls: true
                    };
                });
                const option = {
                    backgroundColor: backgroundColor,
                    title: {
                        show: false
                    },
                    tooltip: {
                        trigger: 'axis',
                        backgroundColor: tooltipBackgroundColor,
                        borderColor: tooltipBorderColor,
                        textStyle: {
                            fontSize: fontSize,
                            color: fontColor
                        }
                    },
                    legend: {
                        data: chartData.map(item => item.monitor_name),
                        show: true,
                        textStyle: {
                            fontSize: fontSize,
                            color: fontColor
                        },
                        top: legendTop,
                        bottom: 0,
                        left: legendLeft,
                        padding: legendPadding
                    },
                    xAxis: {
                        type: 'time',
                        data: xAxisData,
                        axisLabel: {
                            textStyle: {
                                fontSize: fontSize
                            }
                        }
                    },
                    yAxis: {
                        type: 'value',
                        axisLabel: {
                            textStyle: {
                                fontSize: fontSize
                            }
                        }
                    },
                    dataZoom: [
                        {
                            type: 'slider',
                            start: 0,
                            end: 100
                        }
                    ],
                    series: seriesData,
                    textStyle: {
                        fontSize: fontSize,
                        color: fontColor
                    },
                    grid: {
                        top: '40',
                        left: gridLeft,
                        right: gridRight
                    }
                };
                chart.setOption(option);
            },
            reloadCharts() { // ÈáçÊñ∞Âä†ËΩΩÊâÄÊúâÂõæË°®
                this.servers.forEach(node => {
                    const id = node.ID;
                    const chartData = this.chartDataList[id - 1];
                    if (chartData) {
                        this.renderCharts(id,true);
                    }
                });
            }
        }
    })
</script>
{{template "theme-server-status/footer" .}}
{{end}}

